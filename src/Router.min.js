var Router=function(){var e=function(e){this._resolved=false;this._route={routeUrl:[],templateUrl:[],otherwise:""};this._cache={};this._view=e||"body";this.init()};var t=e.prototype;t.init=function(){$(window).on("hashchange",{ctx:this},t.onHashChange)};t.filterUrl=function(e,t){var n;if(typeof t=="undefined")t=false;if(typeof e=="undefined")n=this.trimHashUrl(this.getHash());else if(t)n=e;else n=this.trimHashUrl(e);return n};t.getHash=function(){return window.location.hash};t.trimHashUrl=function(e){return e.substring(2)};t.getRoute=function(){return this.filterUrl()};t.when=function(e,t){var n=this.filterUrl(e,true);var r=this.trimHashUrl(this.getHash());this._route.routeUrl[this._route.routeUrl.length]=e;this._route.templateUrl[this._route.templateUrl.length]=t;if(n!=r)return this;this.loadTemplate(e,t);this._resolved=true;return this};t.otherwise=function(e){this._route.otherwise=e;if(this._resolved){this._resolved=false;return 0}this.loadTemplate("otherwise",e);return 1};t.onHashChange=function(e){var t=e.data.ctx;t.refreshView()};t.refreshView=function(){var e=this.getRoute();for(var t=0;t<this._route.routeUrl.length;t++){if(e!=this._route.routeUrl[t])continue;var n=this._route.templateUrl[t];this.loadTemplate(e,n);return 0}var n=this._route.otherwise;this.loadTemplate(e,n);return 1};t.storeCache=function(e,t){this._cache[e]=t};t.loadCache=function(e){return this._cache[e]};t.isCached=function(e){return this._cache[e]};t.loadTemplate=function(e,t){var n=this;$.ajax({url:t,type:"GET",dataType:"html",beforeSend:function(){if(n.isCached(e)){$(n._view).empty().append(n.loadCache(e));return false}return true},success:function(t){n.storeCache(e,t);$(n._view).empty().append(t)}})};return e}()